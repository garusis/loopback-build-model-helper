{"version":3,"sources":["index.js"],"names":["app","ModelBuilder","OwnModel","LoopbackModel","Base","Model","config","settings","wrapFunction","fn","fnName","collection","isFunction","oldFn","args","toArray","arguments","cb","length","pop","push","apply","then","response","catch","assing","forEach","prototype","assign","remoteMethod","name","options","build","resolve","reject","once"],"mappings":"AAAA;;;;;;AAEA;;;;AACA;;;;;;AAEA,IAAIA,YAAJ;;AAEA,SAASC,YAAT,CAAsBC,QAAtB,EAAgCC,aAAhC,EAA+C;AAC3C,SAAKC,IAAL,GAAYF,QAAZ;AACA,SAAKG,KAAL,GAAaF,aAAb;AACH;;AAEDF,aAAaK,MAAb,GAAsB,UAAUC,QAAV,EAAoB;AACtCP,UAAMO,SAASP,GAAf;AACH,CAFD;;AAIA,SAASQ,YAAT,CAAsBC,EAAtB,EAA0BC,MAA1B,EAAkCC,UAAlC,EAA8C;AAC1C,QAAI,CAAC,iBAAEC,UAAF,CAAaH,EAAb,CAAL,EAAuB;;AAEvB,QAAII,QAAQF,WAAWD,MAAX,KAAsB,KAAlC;;AAEAC,eAAWD,MAAX,IAAqB,YAAY;AAC7B,YAAII,OAAO,iBAAEC,OAAF,CAAUC,SAAV,CAAX;AACA,YAAIC,KAAK,iBAAEL,UAAF,CAAaE,KAAKA,KAAKI,MAAL,GAAc,CAAnB,CAAb,IAAsCJ,KAAKK,GAAL,EAAtC,GAAmD,KAAK,CAAjE;;AAEA,YAAIN,KAAJ,EAAWC,KAAKM,IAAL,CAAUP,KAAV;;AAEX,YAAI,CAACI,EAAL,EAAS,OAAOR,GAAGY,KAAH,CAAS,IAAT,EAAeP,IAAf,CAAP;;AAETL,WAAGY,KAAH,CAAS,IAAT,EAAeP,IAAf,EACKQ,IADL,CACU,UAACC,QAAD;AAAA,mBAAcN,GAAG,IAAH,EAASM,QAAT,CAAd;AAAA,SADV,EAEKC,KAFL,CAEWP,EAFX;AAGH,KAXD;AAYH;;AAGDhB,aAAawB,MAAb,GAAsB,UAAUrB,IAAV,EAAgBC,KAAhB,EAAuB;AACzC,qBAAEqB,OAAF,CAAUtB,IAAV,EAAgBI,YAAhB;AACA,qBAAEkB,OAAF,CAAUtB,KAAKuB,SAAf,EAA0BnB,YAA1B;;AAEA,qBAAEoB,MAAF,CAASvB,KAAT,EAAgBD,IAAhB;AACA,qBAAEwB,MAAF,CAASvB,MAAMsB,SAAf,EAA0BvB,KAAKuB,SAA/B;AACH,CAND;;AASA1B,aAAa0B,SAAb,CAAuBE,YAAvB,GAAsC,UAAUC,IAAV,EAAgBC,OAAhB,EAAyB;AAC3D,SAAK1B,KAAL,CAAWwB,YAAX,CAAwBC,IAAxB,EAA8BC,OAA9B;AACH,CAFD;;AAIA;;;;;;AAMA9B,aAAa0B,SAAb,CAAuBK,KAAvB,GAA+B,YAAY;AAAA;;AACvC,WAAO,uBAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACpClC,YAAImC,IAAJ,CAAS,QAAT,EAAmB,YAAM;AACrBlC,yBAAawB,MAAb,CAAoB,MAAKrB,IAAzB,EAA+B,MAAKC,KAApC;AACA4B,oBAAQ,MAAK7B,IAAb;AACH,SAHD;AAIH,KALM,CAAP;AAMH,CAPD;;AAUA;;;;kBAIeH,Y","file":"index.js","sourcesContent":["\"use strict\"\n\nimport _ from \"lodash\"\nimport Promise from \"bluebird\"\n\nlet app\n\nfunction ModelBuilder(OwnModel, LoopbackModel) {\n    this.Base = OwnModel\n    this.Model = LoopbackModel\n}\n\nModelBuilder.config = function (settings) {\n    app = settings.app\n}\n\nfunction wrapFunction(fn, fnName, collection) {\n    if (!_.isFunction(fn)) return\n\n    let oldFn = collection[fnName] || false\n\n    collection[fnName] = function () {\n        let args = _.toArray(arguments)\n        let cb = _.isFunction(args[args.length - 1]) ? args.pop() : void 0\n\n        if (oldFn) args.push(oldFn)\n\n        if (!cb) return fn.apply(this, args)\n\n        fn.apply(this, args)\n            .then((response) => cb(null, response))\n            .catch(cb)\n    }\n}\n\n\nModelBuilder.assing = function (Base, Model) {\n    _.forEach(Base, wrapFunction)\n    _.forEach(Base.prototype, wrapFunction)\n\n    _.assign(Model, Base)\n    _.assign(Model.prototype, Base.prototype)\n}\n\n\nModelBuilder.prototype.remoteMethod = function (name, options) {\n    this.Model.remoteMethod(name, options)\n}\n\n/**\n *\n * @param Base\n * @param Model\n * @return {Promise}\n */\nModelBuilder.prototype.build = function () {\n    return new Promise((resolve, reject) => {\n        app.once(\"booted\", () => {\n            ModelBuilder.assing(this.Base, this.Model)\n            resolve(this.Base)\n        })\n    })\n}\n\n\n/**\n * ModelBuilder class exists to allow you to effectively use the Webstorm autocomplementation tools.\n * @constructor\n */\nexport default ModelBuilder"],"sourceRoot":"./"}