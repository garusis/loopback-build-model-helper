{"version":3,"sources":["index.js"],"names":["app","ModelBuilder","OwnModel","LoopbackModel","Base","Model","config","settings","wrapFunction","fn","fnName","collection","isFunction","args","toArray","cb","length","pop","apply","response","process","nextTick","assing","forEach","prototype","assign","remoteMethod","name","options","build","resolve","reject","once"],"mappings":"AAAA;;;;;;;;;;;;;;;;;;AAEA;;;;AACA;;;;;;AAEA,IAAIA,YAAJ;;AAEA,SAASC,YAAT,CAAsBC,QAAtB,EAAgCC,aAAhC,EAA+C;AAC3C,SAAKC,IAAL,GAAYF,QAAZ;AACA,SAAKG,KAAL,GAAaF,aAAb;AACH;;AAEDF,aAAaK,MAAb,GAAsB,UAAUC,QAAV,EAAoB;AACtCP,UAAMO,SAASP,GAAf;AACH,CAFD;;AAIA,SAASQ,YAAT,CAAsBC,EAAtB,EAA0BC,MAA1B,EAAkCC,UAAlC,EAA8C;AAC1C,QAAI,CAAC,iBAAEC,UAAF,CAAaH,EAAb,CAAL,EAAuB;;AAEvBE,eAAWD,MAAX,+DAAqB;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AACbG,4BADa,GACN,iBAAEC,OAAF,QADM;AAEbC,0BAFa;;AAGjB,4BAAI,iBAAEH,UAAF,CAAaC,KAAKA,KAAKG,MAAL,GAAc,CAAnB,CAAb,CAAJ,EAAyCD,KAAKF,KAAKI,GAAL,EAAL;;AAHxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mDAMQR,GAAGS,KAAH,QAAeL,IAAf,CANR;;AAAA;AAMTM,oDANS;;AAAA,iDAOTJ,EAPS;AAAA;AAAA;AAAA;;AAAA;AAAA,mDAOEK,QAAQC,QAAR,CAAiB;AAAA,2DAAMN,GAAG,IAAH,EAASI,QAAT,CAAN;AAAA,iDAAjB;AAPF;;AAAA;AAAA;AAAA,mDAQNA;AARM;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA,6BAUTJ,EAVS;AAAA;AAAA;AAAA;;AAAA,0DAUEK,QAAQC,QAAR,CAAiB;AAAA,mCAAMN,gBAAN;AAAA,yBAAjB,CAVF;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAArB;AAcH;;AAGDd,aAAaqB,MAAb,GAAsB,UAAUlB,IAAV,EAAgBC,KAAhB,EAAuB;AACzC,qBAAEkB,OAAF,CAAUnB,IAAV,EAAgBI,YAAhB;AACA,qBAAEe,OAAF,CAAUnB,KAAKoB,SAAf,EAA0BhB,YAA1B;;AAEA,qBAAEiB,MAAF,CAASpB,KAAT,EAAgBD,IAAhB;AACA,qBAAEqB,MAAF,CAASpB,MAAMmB,SAAf,EAA0BpB,KAAKoB,SAA/B;AACH,CAND;;AAQAvB,aAAauB,SAAb,CAAuBE,YAAvB,GAAsC,UAAUC,IAAV,EAAgBC,OAAhB,EAAyB;AAC3D,SAAKvB,KAAL,CAAWqB,YAAX,CAAwBC,IAAxB,EAA8BC,OAA9B;AACH,CAFD;;AAIA;;;;;;AAMA3B,aAAauB,SAAb,CAAuBK,KAAvB,GAA+B,YAAY;AAAA;;AACvC,WAAO,uBAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACpC/B,YAAIgC,IAAJ,CAAS,SAAT,EAAoB,YAAM;AACtB/B,yBAAaqB,MAAb,CAAoB,OAAKlB,IAAzB,EAA+B,OAAKC,KAApC;AACAyB,oBAAQ,OAAK1B,IAAb;AACH,SAHD;AAIH,KALM,CAAP;AAMH,CAPD;;AAUA;;;;kBAIeH,Y","file":"index.js","sourcesContent":["\"use strict\"\n\nimport _ from \"lodash\"\nimport Promise from \"bluebird\"\n\nlet app\n\nfunction ModelBuilder(OwnModel, LoopbackModel) {\n    this.Base = OwnModel\n    this.Model = LoopbackModel\n}\n\nModelBuilder.config = function (settings) {\n    app = settings.app\n}\n\nfunction wrapFunction(fn, fnName, collection) {\n    if (!_.isFunction(fn)) return\n\n    collection[fnName] = async function () {\n        let args = _.toArray(arguments)\n        let cb\n        if (_.isFunction(args[args.length - 1])) cb = args.pop()\n\n        try {\n            let response = await fn.apply(this, args)\n            if (cb) return process.nextTick(() => cb(null, response))\n            return response\n        } catch (err) {\n            if (cb) return process.nextTick(() => cb(err))\n            throw err\n        }\n    }\n}\n\n\nModelBuilder.assing = function (Base, Model) {\n    _.forEach(Base, wrapFunction)\n    _.forEach(Base.prototype, wrapFunction)\n\n    _.assign(Model, Base)\n    _.assign(Model.prototype, Base.prototype)\n}\n\nModelBuilder.prototype.remoteMethod = function (name, options) {\n    this.Model.remoteMethod(name, options)\n}\n\n/**\n *\n * @param Base\n * @param Model\n * @return {Promise}\n */\nModelBuilder.prototype.build = function () {\n    return new Promise((resolve, reject) => {\n        app.once(\"started\", () => {\n            ModelBuilder.assing(this.Base, this.Model)\n            resolve(this.Base)\n        })\n    })\n}\n\n\n/**\n * ModelBuilder class exists to allow you to effectively use the Webstorm autocomplementation tools.\n * @constructor\n */\nexport default ModelBuilder"],"sourceRoot":"./"}